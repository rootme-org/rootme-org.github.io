<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Documentation - Stored XSS - Root-Me Blog</title><meta name="Description" content="This is my cool site"><meta property="og:title" content="Documentation - Stored XSS" />
<meta property="og:description" content="Prérequis Pour comprendre l&rsquo;ensemble de cet article, il vous faudra:
 Savoir coder en HTML Connaître les bases du PHP et du Javascript Savoir ce qu&rsquo;est une XSS  Définition Une XSS stockée est possible lorsque l&rsquo;entrée utilisateur est stockée en base de données et afficher sur la page. On peut prendre comme exemple une page de forum.
Explication de la faille Prenons comme exemple une page de forum qui affiche les messages postés." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.root-me.org/documentation/stored_xss/" /><meta property="article:section" content="documentation" />
<meta property="article:published_time" content="2023-02-21T17:46:16+01:00" />
<meta property="article:modified_time" content="2023-02-21T17:46:16+01:00" /><meta property="og:site_name" content="Root-Me Blog" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Documentation - Stored XSS"/>
<meta name="twitter:description" content="Prérequis Pour comprendre l&rsquo;ensemble de cet article, il vous faudra:
 Savoir coder en HTML Connaître les bases du PHP et du Javascript Savoir ce qu&rsquo;est une XSS  Définition Une XSS stockée est possible lorsque l&rsquo;entrée utilisateur est stockée en base de données et afficher sur la page. On peut prendre comme exemple une page de forum.
Explication de la faille Prenons comme exemple une page de forum qui affiche les messages postés."/>
<meta name="application-name" content="Root-Me Blog">
<meta name="apple-mobile-web-app-title" content="Root-Me Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.root-me.org/documentation/stored_xss/" /><link rel="next" href="https://blog.root-me.org/documentation/reflected_xss/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Documentation - Stored XSS",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.root-me.org\/documentation\/stored_xss\/"
        },"genre": "documentation","keywords": "documentation, xss, stored","wordcount":  268 ,
        "url": "https:\/\/blog.root-me.org\/documentation\/stored_xss\/","datePublished": "2023-02-21T17:46:16+01:00","dateModified": "2023-02-21T17:46:16+01:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Ruulian, Podalirius"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Root-Me Blog">Root-Me Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/documentation/"> Documentation </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Root-Me Blog">Root-Me Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/documentation/" title="">Documentation</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">Documentation - Stored XSS</h1><div class="content" id="content"><h2 id="prérequis">Prérequis</h2>
<p>Pour comprendre l&rsquo;ensemble de cet article, il vous faudra:</p>
<ul>
<li>Savoir coder en HTML</li>
<li>Connaître les bases du PHP et du Javascript</li>
<li>Savoir ce qu&rsquo;est une XSS</li>
</ul>
<h2 id="définition">Définition</h2>
<p>Une XSS stockée est possible lorsque l&rsquo;entrée utilisateur est stockée en base de données et afficher sur la page. On peut prendre comme exemple une page de forum.</p>
<h2 id="explication-de-la-faille">Explication de la faille</h2>
<p>Prenons comme exemple une page de forum qui affiche les messages postés.</p>
<p>Voici la partie du code PHP qui affiche les messages :</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="c1">//Connexion à la base de données//
</span><span class="c1"></span>
<span class="c1">// Récupération des informations grâce à une requête SQL
</span><span class="c1"></span><span class="nv">$request</span> <span class="o">=</span> <span class="nv">$database</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s1">&#39;SELECT user, message FROM messages ORDER BY id DESC LIMIT 0, 5&#39;</span><span class="p">);</span>

<span class="c1">// Affichage des messages
</span><span class="c1"></span><span class="k">while</span><span class="p">(</span><span class="nv">$data</span> <span class="o">=</span> <span class="nv">$request</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">()){</span>
    <span class="k">echo</span> <span class="s2">&#34;&lt;p&gt;&#34;</span> <span class="o">.</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&#34;: &#34;</span> <span class="o">.</span> <span class="nv">$data</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&#34;&lt;/p&gt;&#34;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>La partie intéressante dans ce code, est la fonction <!-- raw HTML omitted -->echo<!-- raw HTML omitted -->, qui affiche les messages et les pseudos sans filtre. Ceci nous permet donc d&rsquo;entrer des balises qui vont par la suite être interprétées.</p>
<p>Par exemple si on tente d&rsquo;injecter <code>&lt;u&gt;bonjour&lt;/u&gt;</code> le rendu sur la page sera: <!-- raw HTML omitted -->bonjour<!-- raw HTML omitted --></p>
<p>La fonction <!-- raw HTML omitted -->echo<!-- raw HTML omitted --> interprète les balises.
Vous demandez sûrement en quoi c&rsquo;est dangereux qu&rsquo;un utilisateur envoie un message souligné, et bien c&rsquo;est parce que si <!-- raw HTML omitted -->echo<!-- raw HTML omitted --> interprète les balises <!-- raw HTML omitted -->u<!-- raw HTML omitted -->, il va aussi interpréter les balises <!-- raw HTML omitted -->script<!-- raw HTML omitted -->.</p>
<h2 id="exploitation">Exploitation</h2>
<p>Maintenant qu&rsquo;on a la capacité d&rsquo;interpréter nos balises, on peut passer à l&rsquo;exploitation. En entrant <!-- raw HTML omitted -->alert()<!-- raw HTML omitted --> au moment du chargement de la page le script va être exécuté, et l&rsquo;alert va être affiché. À partir du moment où on peut exécuter du Javascript on peut par exemple récupérer les cookies des autres utilisateurs. <!-- raw HTML omitted --></p>
<h2 id="références">Références</h2>
<ul>
<li><a href="https://portswigger.net/web-security/cross-site-scripting" target="_blank" rel="noopener noreffer ">https://portswigger.net/web-security/cross-site-scripting</a></li>
<li><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" target="_blank" rel="noopener noreffer ">https://portswigger.net/web-security/cross-site-scripting/cheat-sheet</a></li>
</ul>
</div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://root-me.org" target="_blank">Root-Me</a></span>&nbsp;|&nbsp;<span class="license">contact@root-me.org | <a href='/privacy/'>Privacy</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
