<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Documentation - HTTP Response Splitting - Root-Me Blog</title><meta name="Description" content="This is my cool site"><meta property="og:title" content="Documentation - HTTP Response Splitting" />
<meta property="og:description" content="Brève explication de comment le cache fonctionne Pour exploiter cette vulnérabilité nous devrons comprendre comment le cache fonctionne. Pour augmenter la vitesse de réponse, le cache stocke les réponses du serveur associées aux requêtes comme ceci:
/login =&gt; login page /admin =&gt; admin page /register =&gt; register page /posts =&gt; posts page Donc quand on fait une requête sur /posts par exemple, le cache nous envoie la réponse du serveur qui est associée à /posts stockée en cache." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.root-me.org/documentation/http_response_splitting/" /><meta property="article:section" content="documentation" />
<meta property="article:published_time" content="2023-02-21T17:46:16+01:00" />
<meta property="article:modified_time" content="2023-02-21T17:46:16+01:00" /><meta property="og:site_name" content="Root-Me Blog" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Documentation - HTTP Response Splitting"/>
<meta name="twitter:description" content="Brève explication de comment le cache fonctionne Pour exploiter cette vulnérabilité nous devrons comprendre comment le cache fonctionne. Pour augmenter la vitesse de réponse, le cache stocke les réponses du serveur associées aux requêtes comme ceci:
/login =&gt; login page /admin =&gt; admin page /register =&gt; register page /posts =&gt; posts page Donc quand on fait une requête sur /posts par exemple, le cache nous envoie la réponse du serveur qui est associée à /posts stockée en cache."/>
<meta name="application-name" content="Root-Me Blog">
<meta name="apple-mobile-web-app-title" content="Root-Me Blog"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://blog.root-me.org/documentation/http_response_splitting/" /><link rel="prev" href="https://blog.root-me.org/documentation/couche_transport/" /><link rel="next" href="https://blog.root-me.org/documentation/dom_based_xss/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Documentation - HTTP Response Splitting",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/blog.root-me.org\/documentation\/http_response_splitting\/"
        },"genre": "documentation","keywords": "documentation, response splitting","wordcount":  423 ,
        "url": "https:\/\/blog.root-me.org\/documentation\/http_response_splitting\/","datePublished": "2023-02-21T17:46:16+01:00","dateModified": "2023-02-21T17:46:16+01:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Ruulian, Podalirius"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Root-Me Blog">Root-Me Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/documentation/"> Documentation </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Root-Me Blog">Root-Me Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/documentation/" title="">Documentation</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="page single special"><h1 class="single-title animate__animated animate__pulse animate__faster">Documentation - HTTP Response Splitting</h1><div class="content" id="content"><h2 id="brève-explication-de-comment-le-cache-fonctionne">Brève explication de comment le cache fonctionne</h2>
<p>Pour exploiter cette vulnérabilité nous devrons comprendre comment le cache fonctionne. Pour augmenter la vitesse de réponse, le cache stocke les réponses du serveur associées aux requêtes comme ceci:</p>
<pre tabindex="0"><code>/login =&gt; login page
/admin =&gt; admin page
/register =&gt; register page
/posts =&gt; posts page
</code></pre><p>Donc quand on fait une requête sur /posts par exemple, le cache nous envoie la réponse du serveur qui est associée à /posts stockée en cache.</p>
<h2 id="quest-ce-que-la-faille-http-response-splitting-">Qu&rsquo;est ce que la faille HTTP Response Splitting ?</h2>
<p>La faille HTTP Response Splitting est un type de CRLF où le but est d&rsquo;injecter une seconde réponse.</p>
<pre tabindex="0"><code>HTTP/1.1 302 FOUND
[...]
Set-Cookie: theme=dark

HTTP/1.1 200 OK
[...]
</code></pre><p>Ici, on a la réponse prévue par le serveur avec notre cookie dans les headers. Grâce à la présence d&rsquo;une entrée utilisateur dans les headers, on peut exploiter une CRLF pour injecter non pas un nouvel header, mais une réponse toute entière !</p>
<h2 id="comment-utiliser-cette-faille-pour-exploiter-une-xss-">Comment utiliser cette faille pour exploiter une XSS ?</h2>
<p>En effectuant cette injection, il n&rsquo;y a pas d&rsquo;impact apparent dans notre navigateur mais on peut exploiter le cache. Après l&rsquo;injection, la seconde réponse (la réponse injectée) n&rsquo;est pas stockée dans le cache car elle n&rsquo;a pas de requête associée, le cache va donc attendre quelques secondes de recevoir une requête à laquelle accrocher cette réponse &ldquo;célibataire&rdquo;.</p>
<p>Ce qui signifie que si on fait une requête juste après l&rsquo;injection, cette requête va être associée à la réponse injectée et quand d&rsquo;autres utilisateurs vont GET cette url, ils vont recevoir la réponse injectée.
Maintenant nous avons juste à ajouter du code Javascript dans le contenu de notre réponse injectée.</p>
<h2 id="exploit">Exploit</h2>
<p>Premièrement, nous devons vider le cache pour supprimer toutes les réponses associées aux requêtes ou nous ne serons pas en capacité de les modifier.
Deuxièmement, nous devons effectuer notre injection.
Enfin, on doit faire une requête sur la page dont qu&rsquo;on souhaite associer à notre réponse.</p>
<p>Voici un pseudo-code pour réussir notre exploit:</p>
<pre tabindex="0"><code># Requête sur la page à exploiter pour vider le cache
# Requête contenant notre injection
# Requête sur la page à exploiter pour associer cette requête à la réponse qui attend en cache
</code></pre><h2 id="comment-savoir-si-lexploit-a-réussi">Comment savoir si l&rsquo;exploit a réussi</h2>
<p>Pour savoir si l&rsquo;exploit a réussi il suffit de regarder le contenu de la page à exploiter, si le contenu affiché est le code Javascript injecté alors l&rsquo;exploit a fonctionné, si à l&rsquo;inverse le contenu de la page est le même que celui prévu initialement on est bon pour revoir notre exploit.</p>
<h2 id="références">Références</h2>
<ul>
<li><a href="https://owasp.org/www-community/attacks/HTTP_Response_Splitting" target="_blank" rel="noopener noreffer ">https://owasp.org/www-community/attacks/HTTP_Response_Splitting</a></li>
</ul>
</div></div></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://root-me.org" target="_blank">Root-Me</a></span>&nbsp;|&nbsp;<span class="license">contact@root-me.org | <a href='/privacy/'>Privacy</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"lightgallery":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
